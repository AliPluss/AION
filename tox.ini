[tox]
envlist = py38,py39,py310,py311,py312,lint,type-check
isolated_build = true
skip_missing_interpreters = true

[testenv]
deps = 
    pytest>=7.0.0
    pytest-cov>=4.1.0
    pytest-mock>=3.11.1
commands = 
    pytest {posargs}

[testenv:lint]
deps = 
    flake8>=6.0.0
    black>=23.0.0
commands = 
    flake8 .
    black --check .

[testenv:type-check]
deps = 
    mypy>=1.0.0
commands = 
    mypy . --ignore-missing-imports

[testenv:security]
deps = 
    bandit>=1.7.5
    safety>=2.3.0
commands = 
    bandit -r . -f json -o bandit-report.json
    safety check

[testenv:docs]
deps = 
    sphinx>=7.1.0
    sphinx-rtd-theme>=1.3.0
commands = 
    sphinx-build -b html docs docs/_build/html

[flake8]
max-line-length = 127
exclude = .tox,venv,aion_env,build,dist
ignore = E203,W503

[coverage:run]
source = .
omit = 
    */tests/*
    */venv/*
    */aion_env/*
    setup.py
    */migrations/*

[coverage:report]
exclude_lines =
    pragma: no cover
    def __repr__
    raise AssertionError
    raise NotImplementedError
